# Example secrets configuration for CC-Registry-V2
# DO NOT commit actual secrets to git!
# Use sealed-secrets, external-secrets, or your cluster's secret management solution
#
# IMPORTANT: Azure OpenAI Credentials
# - GPT/Chat credentials: Used by cc-registry-v2 backend for AI enhancement features
# - Embedding credentials: Used by MCP server for semantic search/vector embeddings
# - These can be the SAME resource (same endpoint/key) with different deployments
# - OR separate resources if you have embeddings on a different Azure OpenAI instance
# - If embedding credentials are not provided, MCP server falls back to main credentials

---
apiVersion: v1
kind: Namespace
metadata:
  name: codecollection-registry
---
apiVersion: v1
kind: Secret
metadata:
  name: cc-registry-secrets
  namespace: codecollection-registry
type: Opaque
stringData:
  # ============================================================================
  # Database Configuration
  # ============================================================================
  # Option 1: Provide a complete DATABASE_URL (simple, for standalone databases)
  # database-url: "postgresql://user:password@postgres:5432/codecollection_registry"
  
  # Option 2: Provide individual components (recommended for managed databases)
  # The application will construct the DATABASE_URL from these components
  DB_HOST: "your-postgres-host.database.azure.com"
  DB_PORT: "5432"
  DB_USER: "postgres@your-server"
  DB_PASSWORD: "your-secure-password"
  DB_NAME: "codecollection_registry"
  
  # ============================================================================
  # Redis Configuration
  # ============================================================================
  # Option 1: Standalone Redis - Provide a complete REDIS_URL
  # redis-url: "redis://redis:6379/0"
  # redis-url: "redis://:password@redis:6379/0"  # With password
  
  # Option 2: Redis Sentinel (recommended for HA deployments)
  # Provide Sentinel hosts and master name
  REDIS_SENTINEL_HOSTS: "redis-sentinel-0.redis-sentinel:26379,redis-sentinel-1.redis-sentinel:26379,redis-sentinel-2.redis-sentinel:26379"
  REDIS_SENTINEL_MASTER: "mymaster"
  REDIS_PASSWORD: "your-redis-password"  # Optional, if Redis requires auth
  REDIS_DB: "0"
---
apiVersion: v1
kind: Secret
metadata:
  name: azure-openai-credentials
  namespace: codecollection-registry
type: Opaque
stringData:
  # Azure OpenAI for GPT/Chat (used by backend AI enhancement)
  AZURE_OPENAI_API_KEY: "your-api-key-here"
  AZURE_OPENAI_ENDPOINT: "https://your-instance.openai.azure.com/"
  AZURE_OPENAI_API_VERSION: "2024-02-15-preview"
  AZURE_OPENAI_DEPLOYMENT_NAME: "gpt-4"
  AZURE_OPENAI_DEPLOYMENT: "gpt-4"  # Alternative name used by some services
  
  # Azure OpenAI for Embeddings (used by MCP server semantic search)
  # Often embeddings use a different deployment or even different Azure OpenAI resource
  # If not set, MCP server will fall back to the main AZURE_OPENAI_* credentials above
  AZURE_OPENAI_EMBEDDING_API_KEY: "your-embedding-api-key-here"
  AZURE_OPENAI_EMBEDDING_ENDPOINT: "https://your-embedding-resource.openai.azure.com/"
  AZURE_OPENAI_EMBEDDING_API_VERSION: "2024-02-15-preview"
  AZURE_OPENAI_EMBEDDING_DEPLOYMENT: "text-embedding-3-small"
  
  # GitHub Token (for MCP server GitHub issue creation - optional)
  GITHUB_TOKEN: "ghp_your_github_token_here"
---
apiVersion: v1
kind: Secret
metadata:
  name: frontend-credentials
  namespace: codecollection-registry
type: Opaque
stringData:
  # Frontend admin login credentials
  REACT_APP_ADMIN_EMAIL: "admin@runwhen.com"  # Email address for admin login
  REACT_APP_ADMIN_PASSWORD: "changeme"        # Password for admin login
---
apiVersion: v1
kind: Secret
metadata:
  name: ghcr-pull-secret
  namespace: codecollection-registry
type: kubernetes.io/dockerconfigjson
stringData:
  .dockerconfigjson: |
    {
      "auths": {
        "ghcr.io": {
          "auth": "BASE64_ENCODED_USERNAME:TOKEN"
        }
      }
    }

# To create the ghcr-pull-secret properly, use:
# kubectl create secret docker-registry ghcr-pull-secret \
#   --docker-server=ghcr.io \
#   --docker-username=YOUR_GITHUB_USERNAME \
#   --docker-password=YOUR_GITHUB_TOKEN \
#   --namespace=codecollection-registry

# Alternative: Create from Docker config file
# kubectl create secret generic ghcr-pull-secret \
#   --from-file=.dockerconfigjson=$HOME/.docker/config.json \
#   --type=kubernetes.io/dockerconfigjson \
#   --namespace=codecollection-registry

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: tag-icon-mappings
  namespace: codecollection-registry
data:
  map-tag-icons.yaml: |
    # Tag icon mappings
    # Add your tag to icon mappings here
    tags:
      kubernetes: "‚ò∏Ô∏è"
      docker: "üê≥"
      python: "üêç"
      javascript: "üìú"
      monitoring: "üìä"
      security: "üîí"

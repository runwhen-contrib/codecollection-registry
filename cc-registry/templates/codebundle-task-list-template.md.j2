<script>
function filterBundles() {
    let selectedCategories = Array.from(document.querySelectorAll("input[name='categoryFilter']:checked"))
        .map(checkbox => checkbox.value.toLowerCase());
    let bundleGroups = document.querySelectorAll(".codebundle-group");
    
    bundleGroups.forEach(group => {
        let bundleCategories = group.getAttribute("data-categories").toLowerCase().split(",").map(cat => cat.trim());
        let show = selectedCategories.length === 0 || selectedCategories.some(cat => bundleCategories.includes(cat));
        group.style.display = show ? "table-row-group" : "none";
    });
}

function filterCategoryList() {
    let searchText = document.getElementById("categorySearch").value.toLowerCase();
    let checkboxes = document.querySelectorAll("#categoryFilters label");
    
    checkboxes.forEach(label => {
        let text = label.textContent.toLowerCase();
        label.style.display = text.includes(searchText) ? "flex" : "none";
    });
}

function clearSelections() {
    document.querySelectorAll("input[name='categoryFilter']").forEach(checkbox => checkbox.checked = false);
    filterBundles();
}
</script>

# CodeBundle Task List

<strong>Filter by Category:</strong>
<input type="text" id="categorySearch" placeholder="Search categories..." onkeyup="filterCategoryList()" style="width: 100%; padding: 5px; margin-bottom: 10px;">
<button onclick="clearSelections()" style="margin-bottom: 10px;">Clear Selection</button>
<div id="categoryFilters" style="display: flex; flex-wrap: wrap; gap: 10px; max-height: 200px; overflow-y: auto; padding: 5px;">
    {% set all_categories = data.codebundles | map(attribute='categories') | sum(start=[]) | unique | sort %}
    
    {% for category in all_categories %}
    <label style="display: flex; align-items: center; gap: 5px;">
        <input type="checkbox" name="categoryFilter" value="{{ category }}" onchange="filterBundles()"> {{ category }}
    </label>
    {% endfor %}
</div>

<table style="width: 100%; border-collapse: collapse; border: none;">
<thead>
<tr style="border: none;">
<th style="border: none;">CodeBundle</th>
</tr>
</thead>
<tbody>
{% for bundle in data.codebundles %}
<tbody class="codebundle-group" data-categories="{{ bundle.categories | join(',') }}">
<tr>
    <td colspan="2" style="font-weight: bold; text-align: left;">
        <h3 style="margin: 0;"><a href="{{ bundle.page_url }}">{{ bundle.codebundle }}</a></h3>
    </td>
</tr>
<tr style="border: none;">
    <td style="font-weight: bold; width: 20%; white-space: nowrap; border: none;">
        {% if bundle.tasks %}TaskSet{% elif bundle.slis %}SLI{% endif %}
    </td>
    <td style="width: 80%; white-space: nowrap; border: none;">
        {% if bundle.tasks %}{{ bundle.tasks | join('<br>') }}{% elif bundle.slis %}{{ bundle.slis | join('<br>') }}{% endif %}
    </td>
</tr>
</tbody>
{% endfor %}
</tbody>
</table>

